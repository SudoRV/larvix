{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\PC\\\\Desktop\\\\projects\\\\larvix\\\\larvix\\\\src\\\\components\\\\FlowCanvas.js\",\n  _s = $RefreshSig$();\nimport React, { useCallback, useEffect } from \"react\";\nimport ReactFlow, { Background, Controls, addEdge, useNodesState, useEdgesState, useReactFlow } from \"reactflow\";\nimport \"reactflow/dist/style.css\";\nimport ChatNode from \"../components/ChatNode\";\n\n/* ✅ Move outside component to prevent warning #002 */\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst nodeTypes = {\n  chat: ChatNode\n};\nexport default function FlowCanvas() {\n  _s();\n  const {\n    zoomIn,\n    zoomOut,\n    setViewport,\n    getViewport,\n    fitView\n  } = useReactFlow();\n\n  /* ✅ Run only once safely after mount */\n  useEffect(() => {\n    const timer = setTimeout(() => {\n      fitView({\n        padding: 0.2\n      });\n    }, 0);\n    return () => clearTimeout(timer);\n  }, [fitView]);\n\n  /* ✅ Custom wheel logic preserved */\n  const handleWheel = useCallback(event => {\n    const {\n      x,\n      y,\n      zoom\n    } = getViewport();\n\n    // CTRL + Scroll → Zoom\n    if (event.ctrlKey) {\n      event.preventDefault();\n      event.deltaY < 0 ? zoomIn({\n        duration: 120\n      }) : zoomOut({\n        duration: 120\n      });\n      return;\n    }\n\n    // SHIFT + Scroll → Horizontal Pan\n    if (event.shiftKey) {\n      setViewport({\n        x: x - event.deltaY,\n        y,\n        zoom\n      });\n      return;\n    }\n\n    // Normal Scroll → Vertical Pan\n    setViewport({\n      x,\n      y: y - event.deltaY,\n      zoom\n    });\n  }, [getViewport, setViewport, zoomIn, zoomOut]);\n  const initialNodes = [{\n    id: \"1\",\n    type: \"chat\",\n    position: {\n      x: 400,\n      y: 100\n    },\n    data: {\n      label: \"Root message\"\n    }\n  }];\n  const [nodes, setNodes, onNodesChange] = useNodesState(initialNodes);\n  const [edges, setEdges, onEdgesChange] = useEdgesState([]);\n  const onConnect = useCallback(params => setEdges(eds => addEdge({\n    ...params,\n    animated: true\n  }, eds)), [setEdges]);\n  const addChild = useCallback(parentId => {\n    const newId = Date.now().toString();\n    const parentNode = nodes.find(n => n.id === parentId);\n    if (!parentNode) return;\n    const newNode = {\n      id: newId,\n      type: \"chat\",\n      position: {\n        x: parentNode.position.x,\n        y: parentNode.position.y + 250\n      },\n      data: {\n        label: \"New message\"\n      }\n    };\n    setNodes(nds => [...nds, newNode]);\n    setEdges(eds => [...eds, {\n      id: `e${parentId}-${newId}`,\n      source: parentId,\n      target: newId,\n      animated: true\n    }]);\n  }, [nodes, setNodes, setEdges]);\n  const deleteNode = useCallback(id => {\n    setNodes(nds => nds.filter(n => n.id !== id));\n    setEdges(eds => eds.filter(e => e.source !== id && e.target !== id));\n  }, [setNodes, setEdges]);\n  const nodesWithHandlers = nodes.map(n => ({\n    ...n,\n    data: {\n      ...n.data,\n      onAddChild: addChild,\n      onDelete: deleteNode\n    }\n  }));\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"w-screen h-screen bg-neutral-900\",\n    children: /*#__PURE__*/_jsxDEV(ReactFlow, {\n      nodes: nodesWithHandlers,\n      edges: edges,\n      onNodesChange: onNodesChange,\n      onEdgesChange: onEdgesChange,\n      onConnect: onConnect,\n      nodeTypes: nodeTypes,\n      zoomOnScroll: false,\n      panOnScroll: false,\n      panOnDrag: true,\n      preventScrolling: true,\n      onPaneScroll: handleWheel,\n      defaultViewport: {\n        x: 0,\n        y: 0,\n        zoom: 1\n      },\n      children: [/*#__PURE__*/_jsxDEV(Background, {\n        gap: 20,\n        size: 1,\n        color: \"#444\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 156,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Controls, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 157,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 139,\n    columnNumber: 9\n  }, this);\n}\n_s(FlowCanvas, \"S31af1yY6krAO5bSWLIScjlxxGQ=\", false, function () {\n  return [useReactFlow, useNodesState, useEdgesState];\n});\n_c = FlowCanvas;\nvar _c;\n$RefreshReg$(_c, \"FlowCanvas\");","map":{"version":3,"names":["React","useCallback","useEffect","ReactFlow","Background","Controls","addEdge","useNodesState","useEdgesState","useReactFlow","ChatNode","jsxDEV","_jsxDEV","nodeTypes","chat","FlowCanvas","_s","zoomIn","zoomOut","setViewport","getViewport","fitView","timer","setTimeout","padding","clearTimeout","handleWheel","event","x","y","zoom","ctrlKey","preventDefault","deltaY","duration","shiftKey","initialNodes","id","type","position","data","label","nodes","setNodes","onNodesChange","edges","setEdges","onEdgesChange","onConnect","params","eds","animated","addChild","parentId","newId","Date","now","toString","parentNode","find","n","newNode","nds","source","target","deleteNode","filter","e","nodesWithHandlers","map","onAddChild","onDelete","className","children","zoomOnScroll","panOnScroll","panOnDrag","preventScrolling","onPaneScroll","defaultViewport","gap","size","color","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Users/PC/Desktop/projects/larvix/larvix/src/components/FlowCanvas.js"],"sourcesContent":["import React, { useCallback, useEffect } from \"react\";\r\nimport ReactFlow, {\r\n    Background,\r\n    Controls,\r\n    addEdge,\r\n    useNodesState,\r\n    useEdgesState,\r\n    useReactFlow\r\n} from \"reactflow\";\r\nimport \"reactflow/dist/style.css\";\r\nimport ChatNode from \"../components/ChatNode\";\r\n\r\n/* ✅ Move outside component to prevent warning #002 */\r\nconst nodeTypes = {\r\n    chat: ChatNode\r\n};\r\n\r\nexport default function FlowCanvas() {\r\n    const {\r\n        zoomIn,\r\n        zoomOut,\r\n        setViewport,\r\n        getViewport,\r\n        fitView\r\n    } = useReactFlow();\r\n\r\n    /* ✅ Run only once safely after mount */\r\n    useEffect(() => {\r\n        const timer = setTimeout(() => {\r\n            fitView({ padding: 0.2 });\r\n        }, 0);\r\n\r\n        return () => clearTimeout(timer);\r\n    }, [fitView]);\r\n\r\n    /* ✅ Custom wheel logic preserved */\r\n    const handleWheel = useCallback(\r\n        (event) => {\r\n            const { x, y, zoom } = getViewport();\r\n\r\n            // CTRL + Scroll → Zoom\r\n            if (event.ctrlKey) {\r\n                event.preventDefault();\r\n                event.deltaY < 0\r\n                    ? zoomIn({ duration: 120 })\r\n                    : zoomOut({ duration: 120 });\r\n                return;\r\n            }\r\n\r\n            // SHIFT + Scroll → Horizontal Pan\r\n            if (event.shiftKey) {\r\n                setViewport({\r\n                    x: x - event.deltaY,\r\n                    y,\r\n                    zoom\r\n                });\r\n                return;\r\n            }\r\n\r\n            // Normal Scroll → Vertical Pan\r\n            setViewport({\r\n                x,\r\n                y: y - event.deltaY,\r\n                zoom\r\n            });\r\n        },\r\n        [getViewport, setViewport, zoomIn, zoomOut]\r\n    );\r\n\r\n    const initialNodes = [\r\n        {\r\n            id: \"1\",\r\n            type: \"chat\",\r\n            position: { x: 400, y: 100 },\r\n            data: { label: \"Root message\" }\r\n        }\r\n    ];\r\n\r\n    const [nodes, setNodes, onNodesChange] = useNodesState(initialNodes);\r\n    const [edges, setEdges, onEdgesChange] = useEdgesState([]);\r\n\r\n    const onConnect = useCallback(\r\n        (params) =>\r\n            setEdges((eds) => addEdge({ ...params, animated: true }, eds)),\r\n        [setEdges]\r\n    );\r\n\r\n    const addChild = useCallback(\r\n        (parentId) => {\r\n            const newId = Date.now().toString();\r\n            const parentNode = nodes.find((n) => n.id === parentId);\r\n            if (!parentNode) return;\r\n\r\n            const newNode = {\r\n                id: newId,\r\n                type: \"chat\",\r\n                position: {\r\n                    x: parentNode.position.x,\r\n                    y: parentNode.position.y + 250\r\n                },\r\n                data: { label: \"New message\" }\r\n            };\r\n\r\n            setNodes((nds) => [...nds, newNode]);\r\n\r\n            setEdges((eds) => [\r\n                ...eds,\r\n                {\r\n                    id: `e${parentId}-${newId}`,\r\n                    source: parentId,\r\n                    target: newId,\r\n                    animated: true\r\n                }\r\n            ]);\r\n        },\r\n        [nodes, setNodes, setEdges]\r\n    );\r\n\r\n    const deleteNode = useCallback(\r\n        (id) => {\r\n            setNodes((nds) => nds.filter((n) => n.id !== id));\r\n            setEdges((eds) =>\r\n                eds.filter((e) => e.source !== id && e.target !== id)\r\n            );\r\n        },\r\n        [setNodes, setEdges]\r\n    );\r\n\r\n    const nodesWithHandlers = nodes.map((n) => ({\r\n        ...n,\r\n        data: {\r\n            ...n.data,\r\n            onAddChild: addChild,\r\n            onDelete: deleteNode\r\n        }\r\n    }));\r\n\r\n    return (\r\n        <div\r\n            className=\"w-screen h-screen bg-neutral-900\"\r\n        >\r\n            <ReactFlow\r\n                nodes={nodesWithHandlers}\r\n                edges={edges}\r\n                onNodesChange={onNodesChange}\r\n                onEdgesChange={onEdgesChange}\r\n                onConnect={onConnect}\r\n                nodeTypes={nodeTypes}\r\n                zoomOnScroll={false}\r\n                panOnScroll={false}\r\n                panOnDrag={true}\r\n                preventScrolling={true}\r\n                onPaneScroll={handleWheel}\r\n                defaultViewport={{ x: 0, y: 0, zoom: 1 }}\r\n            >\r\n                <Background gap={20} size={1} color=\"#444\" />\r\n                <Controls />\r\n            </ReactFlow>\r\n        </div>\r\n    );\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}